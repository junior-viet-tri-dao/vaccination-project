<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Xem thông tin các loại vắc xin</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-blue-100 to-green-100 min-h-screen p-6">

<!-- Nút quay lại dashboard normaluser -->
<div class="max-w-7xl mx-auto mb-4 flex justify-start w-full">
    <a href="/normalUser/dashboard"
       class="flex items-center justify-center w-10 h-10 bg-blue-500 text-white rounded-full hover:bg-blue-600 transition"
       title="Quay về Dashboard">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
             stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7"/>
        </svg>
    </a>
</div>

<!-- Container -->
<div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-xl p-6">
    <!-- Title -->
    <h1 class="text-2xl font-bold text-blue-700 mb-6 text-center">
        Xem thông tin các loại vắc xin
    </h1>

    <!-- Search form -->
    <form method="get" th:action="@{/normalUser/view-vaccines}"
          class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4 items-end"
          onsubmit="this.keyword.value = this.keyword.value.trim();">
        <div>
            <label class="block font-medium text-gray-700 mb-1">Tìm kiếm theo</label>
            <select id="searchType" name="searchType" required
                    class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500">
                <option value="">-- Chọn loại tìm kiếm --</option>
                <option value="maVacXin" th:selected="${searchType == 'maVacXin'}">Mã vắc xin</option>
                <option value="tenVacXin" th:selected="${searchType == 'tenVacXin'}">Tên vắc xin</option>
                <option value="phongTriBenh" th:selected="${searchType == 'phongTriBenh'}">Phòng trị bệnh</option>
            </select>
        </div>
        <div class="md:col-span-2">
            <label class="block font-medium text-gray-700 mb-1">Từ khóa</label>
            <!-- Phần input + nút X xóa từ khóa -->
            <div class="relative">
                <input type="text" id="searchKeyword" name="keyword" minlength="2" maxlength="50"
                       th:value="${keyword}" placeholder="Nhập từ khóa..."
                       class="w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500"/>
                <button type="button" onclick="clearKeyword()"
                        class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500"
                        style="display: none;" id="clearKeywordBtn">
                    &#10006;
                </button>
            </div>
            <script>
                const input = document.getElementById('searchKeyword');
                const clearBtn = document.getElementById('clearKeywordBtn');
                function updateClearBtn() {
                    clearBtn.style.display = input.value ? 'block' : 'none';
                }
                input.addEventListener('input', updateClearBtn);
                window.onload = updateClearBtn;
                function clearKeyword() {
                    input.value = '';
                    updateClearBtn();
                    input.form.submit(); // Gửi lại form để hiển thị tất cả
                }
            </script>
        </div>
        <div>
            <button type="submit"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow">
                Tìm
            </button>
        </div>
    </form>

    <!-- Table -->
    <div class="overflow-x-auto mt-8">
        <table class="min-w-full border border-gray-300 text-sm">
            <thead class="bg-gradient-to-r from-blue-500 to-green-500 text-white">
            <tr>
                <th class="px-3 py-2 border text-center">STT</th>
                <th class="px-3 py-2 border text-center">Mã vắc xin</th>
                <th class="px-3 py-2 border text-center">Tên vắc xin</th>
                <th class="px-3 py-2 border text-center">Phòng trị bệnh</th>
                <th class="px-3 py-2 border text-center">Số lượng</th>
                <th class="px-3 py-2 border text-center">Độ tuổi tiêm phòng</th>
            </tr>
            </thead>
            <tbody class="bg-white">
            <tr th:each="item, stat : ${vaccinePage.content}" class="odd:bg-gray-50 even:bg-white">
                <td class="border px-3 py-2 text-center"
                    th:text="${stat.index + 1 + vaccinePage.number * vaccinePage.size}"></td>
                <td class="border px-3 py-2 text-center" th:text="${item.maVacXin}"></td>
                <td class="border px-3 py-2 text-center" th:text="${item.tenVacXin}"></td>
                <td class="border px-3 py-2 text-center" th:text="${item.phongTriBenh}"></td>
                <td class="border px-3 py-2 text-center" th:text="${item.soLuong} + ' liều'"></td>
                <td class="border px-3 py-2 text-center" th:text="${item.doTuoiTiemPhong}"></td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Nếu không có dữ liệu -->
    <div th:if="${vaccinePage.totalElements == 0}"
         class="mt-4 text-center text-red-600 font-semibold">
        Không tìm thấy kết quả phù hợp với từ khóa "<span th:text="${keyword}"></span>".
    </div>

    <!-- Phân trang -->
    <div class="flex justify-center items-center mt-6 space-x-2">
        <div th:if="${vaccinePage.totalPages > 0}"
             class="inline-flex items-center gap-2">
            <!-- Nút Trước -->
            <a th:if="${!vaccinePage.first}"
               th:href="@{/normalUser/view-vaccines(page=${vaccinePage.number - 1}, size=${vaccinePage.size}, searchType=${searchType}, keyword=${keyword})}"
               class="px-4 py-2 rounded-lg transition bg-blue-500 text-white hover:bg-blue-600">
                Trước
            </a>
            <span th:if="${vaccinePage.first}"
                  class="px-4 py-2 rounded-lg bg-gray-300 text-gray-500 cursor-not-allowed">
            Trước
            </span>

            <!-- Số trang -->
            <span th:each="i : ${#numbers.sequence(1, vaccinePage.totalPages)}">
                <a th:href="@{/normalUser/view-vaccines(page=${i - 1}, size=${vaccinePage.size}, searchType=${searchType}, keyword=${keyword})}"
                   th:text="${i}"
                   th:classappend="${i - 1 == vaccinePage.number} ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-700 hover:bg-blue-400 hover:text-white'"
                   class="px-3 py-1 rounded-lg mx-1 text-center transition"></a>
            </span>

            <!-- Nút Sau -->
            <a th:if="${!vaccinePage.last}"
               th:href="@{/normalUser/view-vaccines(page=${vaccinePage.number + 1}, size=${vaccinePage.size}, searchType=${searchType}, keyword=${keyword})}"
               class="px-4 py-2 rounded-lg transition bg-blue-500 text-white hover:bg-blue-600">
                Sau
            </a>
            <span th:if="${vaccinePage.last}"
                  class="px-4 py-2 rounded-lg bg-gray-300 text-gray-500 cursor-not-allowed">
            Sau
            </span>
        </div>
        <!-- Nếu không có dữ liệu -->
        <div th:if="${vaccinePage.totalPages == 0}" class="inline-flex items-center gap-2">
            <span class="px-4 py-2 rounded-lg bg-gray-300 text-gray-500 cursor-not-allowed">
                Trước
            </span>
            <span class="px-3 py-1 rounded-lg bg-blue-600 text-white text-center">1</span>
            <span class="px-4 py-2 rounded-lg bg-gray-300 text-gray-500 cursor-not-allowed">
                Sau
            </span>
        </div>
    </div>
</div>
</body>
</html>